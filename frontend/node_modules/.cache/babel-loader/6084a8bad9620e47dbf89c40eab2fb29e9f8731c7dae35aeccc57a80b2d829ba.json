{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Card,Row,Col,Statistic,Typography,Avatar,List,Tag,Space,message}from'antd';import{UserOutlined,MessageOutlined,TeamOutlined,ClockCircleOutlined,CheckCircleOutlined}from'@ant-design/icons';import{useAuth}from'../../contexts/AuthContext';import'./Dashboard.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const{Title,Text}=Typography;const Dashboard=()=>{const{user,getUsers,refreshUsers}=useAuth();const[loading,setLoading]=useState(true);const users=getUsers();useEffect(()=>{// Only allow admin to access dashboard\nif((user===null||user===void 0?void 0:user.role)!=='admin'){message.error('Bạn không có quyền truy cập trang này');return;}const initDashboard=async()=>{try{setLoading(true);// Refresh users data if needed\nawait refreshUsers();}catch(error){console.error('Error loading dashboard:',error);message.error('Không thể tải dữ liệu bảng điều khiển');}finally{setLoading(false);}};initDashboard();},[user,refreshUsers]);const onlineUsers=users.filter(u=>u.isOnline);const totalUsers=users.length;// If user is not admin, show access denied message\nif((user===null||user===void 0?void 0:user.role)!=='admin'){return/*#__PURE__*/_jsx(\"div\",{className:\"dashboard\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-header\",children:[/*#__PURE__*/_jsx(Title,{level:2,children:\"Kh\\xF4ng c\\xF3 quy\\u1EC1n truy c\\u1EADp\"}),/*#__PURE__*/_jsx(Text,{type:\"secondary\",children:\"B\\u1EA1n kh\\xF4ng c\\xF3 quy\\u1EC1n truy c\\u1EADp trang n\\xE0y. Ch\\u1EC9 admin m\\u1EDBi c\\xF3 th\\u1EC3 xem Dashboard.\"})]})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-header\",children:[/*#__PURE__*/_jsx(Title,{level:2,children:\"Trang ch\\u1EE7\"}),/*#__PURE__*/_jsxs(Text,{type:\"secondary\",children:[\"Ch\\xE0o m\\u1EEBng b\\u1EA1n tr\\u1EDF l\\u1EA1i, \",user===null||user===void 0?void 0:user.username,\"!\"]})]}),/*#__PURE__*/_jsxs(Row,{gutter:[24,24],className:\"stats-row\",children:[/*#__PURE__*/_jsx(Col,{xs:24,sm:12,md:6,children:/*#__PURE__*/_jsx(Card,{className:\"stat-card\",children:/*#__PURE__*/_jsx(Statistic,{title:\"T\\u1ED5ng ng\\u01B0\\u1EDDi d\\xF9ng\",value:totalUsers,prefix:/*#__PURE__*/_jsx(TeamOutlined,{}),valueStyle:{color:'#1890ff'}})})}),/*#__PURE__*/_jsx(Col,{xs:24,sm:12,md:6,children:/*#__PURE__*/_jsx(Card,{className:\"stat-card\",children:/*#__PURE__*/_jsx(Statistic,{title:\"\\u0110ang online\",value:onlineUsers.length,prefix:/*#__PURE__*/_jsx(CheckCircleOutlined,{}),valueStyle:{color:'#52c41a'}})})}),/*#__PURE__*/_jsx(Col,{xs:24,sm:12,md:6,children:/*#__PURE__*/_jsx(Card,{className:\"stat-card\",children:/*#__PURE__*/_jsx(Statistic,{title:\"Tin nh\\u1EAFn h\\xF4m nay\",value:0,prefix:/*#__PURE__*/_jsx(MessageOutlined,{}),valueStyle:{color:'#722ed1'}})})}),/*#__PURE__*/_jsx(Col,{xs:24,sm:12,md:6,children:/*#__PURE__*/_jsx(Card,{className:\"stat-card\",children:/*#__PURE__*/_jsx(Statistic,{title:\"Ho\\u1EA1t \\u0111\\u1ED9ng\",value:onlineUsers.length,prefix:/*#__PURE__*/_jsx(ClockCircleOutlined,{}),valueStyle:{color:'#fa8c16'}})})})]}),/*#__PURE__*/_jsxs(Row,{gutter:[24,24],className:\"content-row\",children:[/*#__PURE__*/_jsx(Col,{xs:24,lg:12,children:/*#__PURE__*/_jsx(Card,{title:\"Ng\\u01B0\\u1EDDi d\\xF9ng \\u0111ang online\",className:\"online-users-card\",children:/*#__PURE__*/_jsx(List,{loading:loading,dataSource:onlineUsers,renderItem:item=>/*#__PURE__*/_jsx(List.Item,{children:/*#__PURE__*/_jsx(List.Item.Meta,{avatar:/*#__PURE__*/_jsx(Avatar,{icon:/*#__PURE__*/_jsx(UserOutlined,{}),src:item.avatar,size:\"default\"}),title:/*#__PURE__*/_jsxs(Space,{children:[item.username,/*#__PURE__*/_jsx(Tag,{color:\"green\",children:\"Online\"})]}),description:item.email})})})})}),/*#__PURE__*/_jsx(Col,{xs:24,lg:12,children:/*#__PURE__*/_jsx(Card,{title:\"Ho\\u1EA1t \\u0111\\u1ED9ng g\\u1EA7n \\u0111\\xE2y\",className:\"activity-card\",children:/*#__PURE__*/_jsx(List,{dataSource:[{title:\"\".concat(user===null||user===void 0?void 0:user.username,\" \\u0111\\xE3 \\u0111\\u0103ng nh\\u1EADp\"),description:'Vừa xong',avatar:/*#__PURE__*/_jsx(UserOutlined,{})}],renderItem:item=>/*#__PURE__*/_jsx(List.Item,{children:/*#__PURE__*/_jsx(List.Item.Meta,{avatar:/*#__PURE__*/_jsx(Avatar,{icon:item.avatar}),title:item.title,description:item.description})})})})})]})]});};export default Dashboard;","map":{"version":3,"names":["React","useState","useEffect","Card","Row","Col","Statistic","Typography","Avatar","List","Tag","Space","message","UserOutlined","MessageOutlined","TeamOutlined","ClockCircleOutlined","CheckCircleOutlined","useAuth","jsx","_jsx","jsxs","_jsxs","Title","Text","Dashboard","user","getUsers","refreshUsers","loading","setLoading","users","role","error","initDashboard","console","onlineUsers","filter","u","isOnline","totalUsers","length","className","children","level","type","username","gutter","xs","sm","md","title","value","prefix","valueStyle","color","lg","dataSource","renderItem","item","Item","Meta","avatar","icon","src","size","description","email","concat"],"sources":["C:/Users/trann/Desktop/jwt-bt/frontend/src/pages/Dashboard/Dashboard.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Card, Row, Col, Statistic, Typography, Avatar, List, Tag, Space, message } from 'antd';\r\nimport { \r\n  UserOutlined, \r\n  MessageOutlined, \r\n  TeamOutlined, \r\n  ClockCircleOutlined,\r\n  CheckCircleOutlined \r\n} from '@ant-design/icons';\r\nimport { useAuth } from '../../contexts/AuthContext';\r\nimport { userAPI } from '../../services/api';\r\nimport { User } from '../../types';\r\nimport './Dashboard.css';\r\n\r\nconst { Title, Text } = Typography;\r\n\r\nconst Dashboard: React.FC = () => {\r\n  const { user, getUsers, refreshUsers } = useAuth();\r\n  const [loading, setLoading] = useState(true);\r\n  const users = getUsers();\r\n\r\n  useEffect(() => {\r\n    // Only allow admin to access dashboard\r\n    if (user?.role !== 'admin') {\r\n      message.error('Bạn không có quyền truy cập trang này');\r\n      return;\r\n    }\r\n\r\n    const initDashboard = async () => {\r\n      try {\r\n        setLoading(true);\r\n        // Refresh users data if needed\r\n        await refreshUsers();\r\n      } catch (error) {\r\n        console.error('Error loading dashboard:', error);\r\n        message.error('Không thể tải dữ liệu bảng điều khiển');\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    initDashboard();\r\n  }, [user, refreshUsers]);\r\n  const onlineUsers = users.filter(u => u.isOnline);\r\n  const totalUsers = users.length;\r\n\r\n  // If user is not admin, show access denied message\r\n  if (user?.role !== 'admin') {\r\n    return (\r\n      <div className=\"dashboard\">\r\n        <div className=\"dashboard-header\">\r\n          <Title level={2}>Không có quyền truy cập</Title>\r\n          <Text type=\"secondary\">Bạn không có quyền truy cập trang này. Chỉ admin mới có thể xem Dashboard.</Text>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"dashboard\">\r\n      <div className=\"dashboard-header\">\r\n        <Title level={2}>Trang chủ</Title>\r\n        <Text type=\"secondary\">Chào mừng bạn trở lại, {user?.username}!</Text>\r\n      </div>\r\n\r\n      <Row gutter={[24, 24]} className=\"stats-row\">\r\n        <Col xs={24} sm={12} md={6}>\r\n          <Card className=\"stat-card\">\r\n            <Statistic\r\n              title=\"Tổng người dùng\"\r\n              value={totalUsers}\r\n              prefix={<TeamOutlined />}\r\n              valueStyle={{ color: '#1890ff' }}\r\n            />\r\n          </Card>\r\n        </Col>\r\n        <Col xs={24} sm={12} md={6}>\r\n          <Card className=\"stat-card\">\r\n            <Statistic\r\n              title=\"Đang online\"\r\n              value={onlineUsers.length}\r\n              prefix={<CheckCircleOutlined />}\r\n              valueStyle={{ color: '#52c41a' }}\r\n            />\r\n          </Card>\r\n        </Col>\r\n        <Col xs={24} sm={12} md={6}>\r\n          <Card className=\"stat-card\">\r\n            <Statistic\r\n              title=\"Tin nhắn hôm nay\"\r\n              value={0}\r\n              prefix={<MessageOutlined />}\r\n              valueStyle={{ color: '#722ed1' }}\r\n            />\r\n          </Card>\r\n        </Col>\r\n        <Col xs={24} sm={12} md={6}>\r\n          <Card className=\"stat-card\">\r\n            <Statistic\r\n              title=\"Hoạt động\"\r\n              value={onlineUsers.length}\r\n              prefix={<ClockCircleOutlined />}\r\n              valueStyle={{ color: '#fa8c16' }}\r\n            />\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n\r\n      <Row gutter={[24, 24]} className=\"content-row\">\r\n        <Col xs={24} lg={12}>\r\n          <Card title=\"Người dùng đang online\" className=\"online-users-card\">\r\n            <List\r\n              loading={loading}\r\n              dataSource={onlineUsers}\r\n              renderItem={(item) => (\r\n                <List.Item>\r\n                  <List.Item.Meta\r\n                    avatar={\r\n                      <Avatar \r\n                        icon={<UserOutlined />} \r\n                        src={item.avatar}\r\n                        size=\"default\"\r\n                      />\r\n                    }\r\n                    title={                      <Space>\r\n                        {item.username}\r\n                        <Tag color=\"green\">Online</Tag>\r\n                      </Space>\r\n                    }\r\n                    description={item.email}\r\n                  />\r\n                </List.Item>\r\n              )}\r\n            />\r\n          </Card>\r\n        </Col>\r\n        <Col xs={24} lg={12}>\r\n          <Card title=\"Hoạt động gần đây\" className=\"activity-card\">\r\n            <List\r\n              dataSource={[\r\n                {\r\n                  title: `${user?.username} đã đăng nhập`,\r\n                  description: 'Vừa xong',\r\n                  avatar: <UserOutlined />\r\n                }\r\n              ]}\r\n              renderItem={(item) => (\r\n                <List.Item>\r\n                  <List.Item.Meta\r\n                    avatar={<Avatar icon={item.avatar} />}\r\n                    title={item.title}\r\n                    description={item.description}\r\n                  />\r\n                </List.Item>\r\n              )}\r\n            />\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Dashboard;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}